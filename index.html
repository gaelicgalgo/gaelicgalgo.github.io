<!DOCTYPE html>
<html lang="de">
<head>
    <!-- Unveränderte Kopfbereiche bleiben erhalten -->
    <style>
        /* Unveränderte CSS-Styles bleiben erhalten */
    </style>
</head>
<body>
    <!-- Unveränderte HTML-Struktur bleibt erhalten -->

    <script>
document.addEventListener("DOMContentLoaded", function() {
    // ... bestehender Initialisierungscode ...

    function showSection(targetId) {
        contentSections.forEach(section => {
            if (section.id === targetId) {
                section.style.display = "block";
                if (section.id === 'bilder-schottland') {
                    initializeFortWilliamAccordion();
                    initializeFortWilliamSubGalleryModal(); // Initialisierung beim Laden
                }
            }
        });
    }
});

// ENTFERNT: Doppelte Funktionsdefinition

function initializeFortWilliamAccordion() {
    const toggleButton = document.getElementById("fortWilliamAccordionToggle");
    const contentDiv = document.getElementById("fortWilliamAccordionContent");

    toggleButton?.addEventListener("click", function() {
        if (contentDiv.style.display === "block") {
            contentDiv.style.display = "none";
        } else {
            contentDiv.style.display = "block";
            initializeFortWilliamSubGalleryModal(); // KRITISCH: Neuinitialisierung beim Öffnen
        }
    });
}

function initializeFortWilliamSubGalleryModal() {
    const modal = document.getElementById("imageModalFortWilliamSub");
    const modalImg = document.getElementById("modalImageFortWilliamSub");
    const caption = document.getElementById("modalCaptionFortWilliamSub");
    const galleryItems = document.querySelectorAll("#fortWilliamSubGalleryContainer .gallery-item");
    const closeBtn = document.getElementById("closeFortWilliamSubModal");

    // Alte Listener entfernen
    galleryItems.forEach(item => {
        item.removeEventListener("click", handleImageClick);
    });

    // Neue Listener hinzufügen
    const handleImageClick = function() {
        modal.style.display = "block";
        modalImg.src = this.querySelector("img").dataset.fullsrc;
        caption.textContent = this.querySelector(".filename").textContent;
    };

    galleryItems.forEach(item => {
        item.addEventListener("click", handleImageClick);
    });

    // Schließmechanismus
    closeBtn?.addEventListener("click", () => modal.style.display = "none");
    window.addEventListener("click", (e) => e.target === modal && (modal.style.display = "none"));
}
    </script>
</body>
</html>









